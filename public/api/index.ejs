var _SiteLayoutService;

<% include jquery.js %>

  function siteLayoutService(opts) {
    _SiteLayoutService = opts || {};
    _SiteLayoutService.headerFooterContainer = _SiteLayoutService.headerFooterContainer || 'body';
    _SiteLayoutService.headerHtmlFragment = '<%-currHost%>/header.html';
    _SiteLayoutService.footerHtmlFragment = '<%-currHost%>/footer.html';

    $(function($jQ) {
      // download css
      <% cssFiles.forEach(function(f) { %>
        $jQ('head').append('<link rel="stylesheet" href="<%=f%>"/>'); <%
      }); %>

      $jQ.ajaxSetup({
        cache: true
      });
      // download js
      <% jsFiles.forEach(function(f) { %>
        $jQ.getScript("<%=currHost%>/js/<%=f%>").done(function() { <%
        }); %>
        // download header and footer after js are loaded
        $jQ.get(opts.headerHtmlFragment, function(data) {
          try {
            $jQ(_SiteLayoutService.headerFooterContainer).first().prepend(data);
          }
          catch (err) {}
          $jQ(document).trigger('headerLoaded');
        });
        $jQ.get(opts.footerHtmlFragment, function(data) {
          try {
            $jQ(_SiteLayoutService.headerFooterContainer).first().append(data);
          }
          catch (err) {}
          $jQ(document).trigger('footerLoaded');
        }); <% jsFiles.forEach(function(f) { %>
        }); <%
      }); %>
    });
  };